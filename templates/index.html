<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Proactive Insurance Policy Guardian</title>
    <link
      href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />
    <style>
      .gradient-bg {
        background: linear-gradient(135deg, #6e8efb, #a777e3);
      }
      .file-upload {
        border: 2px dashed #6e8efb;
        transition: all 0.3s;
      }
      .file-upload:hover {
        background-color: #f8fafc;
        border-color: #3b82f6;
      }
    </style>
  </head>
  <body class="bg-gray-50 min-h-screen">
    <div class="container mx-auto px-4 py-8">
      <!-- Header -->
      <header class="gradient-bg text-white rounded-xl p-6 mb-8 shadow-lg">
        <div class="flex items-center justify-between">
          <div>
            <h1 class="text-3xl font-bold">
              <i class="fas fa-shield-alt mr-2"></i> Proactive Insurance Policy
              Guardian
            </h1>
            <p class="mt-2">Your AI-powered policy analysis assistant</p>
          </div>
          <div class="bg-white/20 p-3 rounded-full">
            <i class="fas fa-robot text-2xl"></i>
          </div>
        </div>
      </header>

      <!-- Main Section -->
      <div class="flex flex-col lg:flex-row gap-8">
        <!-- Sidebar -->
        <aside class="w-full lg:w-1/4 bg-white p-6 rounded-xl shadow-md">
          <h2 class="text-xl font-semibold mb-4">
            <i class="fas fa-question-circle mr-2 text-blue-500"></i> How It
            Works
          </h2>
          <ol class="list-decimal pl-5 space-y-2 text-gray-600">
            <li>Upload your policy PDF</li>
            <li>Ask questions in plain English</li>
            <li>Get instant expert analysis</li>
            <li>Receive proactive recommendations</li>
          </ol>

          <h2 class="text-xl font-semibold mb-4 mt-8">
            <i class="fas fa-lightbulb mr-2 text-yellow-500"></i> Sample
            Questions
          </h2>
          <div class="space-y-2">
            <button
              onclick="setQuestion('What is my deductible?')"
              class="w-full text-left bg-blue-50 hover:bg-blue-100 text-blue-800 p-3 rounded-lg"
            >
              <i class="fas fa-dollar-sign mr-2"></i> What’s my deductible?
            </button>
            <button
              onclick="setQuestion('Am I covered for flood damage?')"
              class="w-full text-left bg-blue-50 hover:bg-blue-100 text-blue-800 p-3 rounded-lg"
            >
              <i class="fas fa-water mr-2"></i> Flood coverage?
            </button>
            <button
              onclick="setQuestion('Are there any coverage gaps in my policy?')"
              class="w-full text-left bg-blue-50 hover:bg-blue-100 text-blue-800 p-3 rounded-lg"
            >
              <i class="fas fa-search-minus mr-2"></i> Coverage gaps?
            </button>
          </div>
        </aside>

        <!-- Main Interaction Panel -->
        <main class="flex-1">
          <!-- Upload Form -->
          <div class="bg-white p-6 rounded-xl shadow-md mb-6">
            <h2 class="text-xl font-semibold mb-4">
              <i class="fas fa-file-pdf mr-2 text-red-500"></i> Upload Your
              Policy
            </h2>
            <form method="POST" enctype="multipart/form-data" id="uploadForm">
              <div
                class="file-upload p-8 text-center rounded-lg cursor-pointer mb-4"
                id="dropZone"
              >
                <input
                  type="file"
                  name="pdf"
                  id="fileInput"
                  class="hidden"
                  accept=".pdf"
                  required
                />
                <label for="fileInput" class="cursor-pointer">
                  <i
                    class="fas fa-cloud-upload-alt text-4xl text-blue-400 mb-2"
                  ></i>
                  <p class="font-medium">Drag & drop your policy PDF here</p>
                  <p class="text-sm text-gray-500">or click to browse files</p>
                </label>
              </div>
              <div id="fileInfo" class="hidden mb-4 p-3 bg-gray-50 rounded-lg">
                <div class="flex justify-between items-center">
                  <span id="fileName" class="font-medium"></span>
                  <button
                    type="button"
                    onclick="clearFile()"
                    class="text-red-500 hover:text-red-700"
                  >
                    <i class="fas fa-times"></i>
                  </button>
                </div>
                <div class="w-full bg-gray-200 rounded-full h-2.5 mt-2">
                  <div
                    id="uploadProgress"
                    class="bg-blue-600 h-2.5 rounded-full"
                    style="width: 0%"
                  ></div>
                </div>
              </div>

              <input type="hidden" name="filename" value="{{ filename }}" />

              <div class="mb-4">
                <label
                  for="questionInput"
                  class="block text-sm font-medium text-gray-700 mb-1"
                  >Your Question</label
                >
                <div class="flex gap-2">
                  <textarea
                    name="question"
                    id="questionInput"
                    rows="3"
                    class="flex-1 p-3 border border-gray-300 rounded-lg"
                    placeholder="Ask about your coverage, exclusions, or recommendations..."
                    required
                  ></textarea>
                  <button
                    type="submit"
                    class="self-end gradient-bg text-white px-6 py-3 rounded-lg hover:opacity-90 transition flex items-center"
                  >
                    <i class="fas fa-paper-plane mr-2"></i> Ask
                  </button>
                </div>
              </div>
            </form>

            {% if filename %}
            <form method="POST">
              <input type="hidden" name="filename" value="{{ filename }}" />
              <button
                type="submit"
                name="summarize"
                class="mt-2 px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600"
              >
                <i class="fas fa-align-left mr-1"></i> Summarize Policy
              </button>
            </form>
            {% endif %}
          </div>

          <!-- Answer Display -->
          <div class="bg-white p-6 rounded-xl shadow-md space-y-4">
            {% if answer %}
            <div class="bg-blue-50 border-l-4 border-blue-400 p-4 rounded">
              <p class="text-blue-800"><strong>Answer:</strong> {{ answer }}</p>
            </div>
            {% endif %} {% if retrieved_context %}
            <div class="bg-gray-100 border p-4 rounded">
              <h3 class="font-semibold mb-2">Context Used:</h3>
              <pre class="text-sm whitespace-pre-wrap">
{{ retrieved_context }}</pre
              >
            </div>
            {% endif %}
          </div>
        </main>
      </div>

      <!-- Footer -->
      <footer class="mt-12 text-center text-gray-500 text-sm">
        <p>
          © 2025 Proactive Insurance Policy Guardian |
          <a href="#" class="text-blue-500 hover:underline">Terms</a> |
          <a href="#" class="text-blue-500 hover:underline">Privacy</a>
        </p>
        <p class="mt-1">
          This AI assistant provides general information only. Consult your
          agent for specific advice.
        </p>
      </footer>
    </div>

    <!-- Script -->
    <script>
      function setQuestion(question) {
        document.getElementById("questionInput").value = question;
        document.getElementById("questionInput").focus();
      }

      const fileInput = document.getElementById("fileInput");
      const dropZone = document.getElementById("dropZone");
      const fileInfo = document.getElementById("fileInfo");
      const fileName = document.getElementById("fileName");
      const uploadProgress = document.getElementById("uploadProgress");

      fileInput.addEventListener("change", function () {
        if (this.files.length) {
          handleFiles(this.files);
        }
      });

      ["dragenter", "dragover", "dragleave", "drop"].forEach((eventName) => {
        dropZone.addEventListener(eventName, preventDefaults, false);
      });

      function preventDefaults(e) {
        e.preventDefault();
        e.stopPropagation();
      }

      ["dragenter", "dragover"].forEach((eventName) => {
        dropZone.addEventListener(
          eventName,
          () => dropZone.classList.add("border-blue-500", "bg-blue-50"),
          false
        );
      });

      ["dragleave", "drop"].forEach((eventName) => {
        dropZone.addEventListener(
          eventName,
          () => dropZone.classList.remove("border-blue-500", "bg-blue-50"),
          false
        );
      });

      dropZone.addEventListener("drop", function (e) {
        const dt = e.dataTransfer;
        const files = dt.files;
        fileInput.files = files;
        handleFiles(files);
      });

      function handleFiles(files) {
        const file = files[0];
        if (file.type === "application/pdf") {
          fileName.textContent = file.name;
          fileInfo.classList.remove("hidden");
          dropZone.classList.add("hidden");

          let progress = 0;
          const interval = setInterval(() => {
            progress += 10;
            uploadProgress.style.width = `${progress}%`;
            if (progress >= 100) clearInterval(interval);
          }, 100);
        } else {
          alert("Please upload a PDF file");
        }
      }

      function clearFile() {
        fileInput.value = "";
        fileInfo.classList.add("hidden");
        dropZone.classList.remove("hidden");
        uploadProgress.style.width = "0%";
      }

      document
        .getElementById("uploadForm")
        .addEventListener("submit", function (e) {
          const submitBtn = this.querySelector("button[type='submit']");
          submitBtn.innerHTML =
            '<i class="fas fa-spinner fa-spin mr-2"></i> Analyzing...';
          submitBtn.disabled = true;
        });
    </script>
  </body>
</html>
